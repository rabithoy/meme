#!/bin/bash
DEVICE_ID=$(cat /dev/urandom | LC_ALL=C tr -dc 'A-F0-9' | dd bs=1 count=64 2>/dev/null && echo) && PUBLIC_IP=$(curl -s ifconfig.me) && sudo docker run -d --name proxyrack --restart always -e UUID="$DEVICE_ID" proxyrack/pop ; sleep 400 && until (curl -s -o /dev/null -w "%{http_code}" -X POST https://peer.proxyrack.com/api/device/add -H 'Api-Key:YKHYS0FPXPRCMCIBDFV4ONBMGIJ8ZHVXNKGFOIEQ' -H 'Content-Type: application/json' -H 'Accept: application/json' -d '{"device_id":"'"$DEVICE_ID"'", "device_name":"'"$PUBLIC_IP"'"}' | grep -q '200'); do echo "Retrying..."; sleep 30; done
